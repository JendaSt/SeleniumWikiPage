<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="773676f5-87a7-4857-8a31-5df7a180bc44" activeEnvironment="Default" name="Nasa" resourceRoot="${projectDir}" soapui-version="5.7.2" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="2e798fc1-750e-4d0f-a075-4abac440b275" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://images-api.nasa.gov" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://images-api.nasa.gov/asset</con:endpoint><con:endpoint>https://images-api.nasa.gov/search</con:endpoint></con:endpoints><con:resource name="" path="" id="95e95c9a-321f-4848-afbf-fb46b397fc7c"><con:settings/><con:parameters/><con:method name="search" id="210f53a0-9526-493c-8fa2-4ffc0de875e2" method="GET"><con:settings/><con:parameters><con:parameter><con:name>keywords</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter><con:parameter><con:name>media_type</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter><con:parameter><con:name>year_start</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter><con:parameter><con:name>year_end</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter><con:parameter><con:name>page_size</con:name><con:value/><con:style>QUERY</con:style><con:default/></con:parameter></con:parameters><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:imag="https://images-api.nasa.gov/">imag:Fault</con:element></con:representation><con:request name="search" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/search</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="keywords" value="Mars"/>
  <con:entry key="media_type" value="video"/>
  <con:entry key="year_start" value="2018"/>
  <con:entry key="year_end" value="2018"/>
  <con:entry key="page_size" value="5"/>
</con:parameters><con:parameterOrder><con:entry>keywords</con:entry><con:entry>media_type</con:entry><con:entry>year_start</con:entry><con:entry>year_end</con:entry><con:entry>page_size</con:entry></con:parameterOrder></con:request></con:method><con:method name="asset" id="210f53a0-9526-493c-8fa2-4ffc0de875e2" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400 404</con:status><con:params/><con:element xmlns:imag="https://images-api.nasa.gov/">imag:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/plain; charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="asset" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/asset/${Properties#nasa_id}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method><con:method name="metadata" id="210f53a0-9526-493c-8fa2-4ffc0de875e2" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400 404</con:status><con:params/><con:element xmlns:imag="https://images-api.nasa.gov/">imag:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/plain; charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="metadata" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/metadata/${Properties#nasa_id}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method><con:method name="album" id="210f53a0-9526-493c-8fa2-4ffc0de875e2" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400 404</con:status><con:params/><con:element xmlns:imag="https://images-api.nasa.gov/">imag:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/plain; charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="album" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/album/${Properties#album_name}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method><con:method name="captions" id="210f53a0-9526-493c-8fa2-4ffc0de875e2" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400 404</con:status><con:params/><con:element xmlns:imag="https://images-api.nasa.gov/">imag:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/plain; charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="captions" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/metadata/${Properties#nasa_id}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource></con:interface><con:testSuite id="6e7bae42-2fa7-466e-853b-ef0e3c343d95" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="2e5f1a95-df26-4dec-bcdb-65e5849bc4cd" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1" searchProperties="true"><con:settings/><con:testStep type="properties" name="Properties" id="bc0c0b63-7ad9-43d8-a4cb-506611727954"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>nasa_id</con:name><con:value>NHQ_2018_0511_ Mars Helicopter Technology Demonstration</con:value></con:property><con:property><con:name>album_name</con:name><con:value>Mars_2020_Perseverance</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="search image" id="747fb651-4133-4b4a-a8ba-232db6707b64"><con:settings/><con:config service="https://images-api.nasa.gov" resourcePath="" methodName="search" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="search image" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/search</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="8fe8ea6e-a17b-4905-a076-71ea5f85ccb0" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="keywords" value="Mars"/>
  <con:entry key="media_type" value="image"/>
  <con:entry key="year_start" value="2018"/>
  <con:entry key="year_end" value="2018"/>
  <con:entry key="page_size" value="5"/>
</con:parameters><con:parameterOrder><con:entry>keywords</con:entry><con:entry>media_type</con:entry><con:entry>year_start</con:entry><con:entry>year_end</con:entry><con:entry>page_size</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="search video" id="5862625e-a871-42ad-bbb2-c01b6b536aa1"><con:settings/><con:config service="https://images-api.nasa.gov" resourcePath="" methodName="search" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="search video" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/search</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="8fe8ea6e-a17b-4905-a076-71ea5f85ccb0" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="keywords" value="Mars"/>
  <con:entry key="media_type" value="video"/>
  <con:entry key="year_start" value="2018"/>
  <con:entry key="year_end" value="2018"/>
  <con:entry key="page_size" value="5"/>
</con:parameters><con:parameterOrder><con:entry>keywords</con:entry><con:entry>media_type</con:entry><con:entry>year_start</con:entry><con:entry>year_end</con:entry><con:entry>page_size</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="asset" id="eb2a88d1-6e95-46fd-9c93-cda652d6f270"><con:settings/><con:config service="https://images-api.nasa.gov" resourcePath="" methodName="asset" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="asset" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/asset/${Properties#nasa_id}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="cb2f04b5-6454-48f9-aaec-1d6cd453d82b" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="metadata" id="2446745b-4fc4-4301-b253-d439c66550ab"><con:settings/><con:config service="https://images-api.nasa.gov" resourcePath="" methodName="metadata" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="metadata" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/metadata/${Properties#nasa_id}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="e3741d59-81b1-48b6-8905-1f568e5504d3" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="captions" id="0457fcc5-8a46-4777-94e6-2ce505ba3ab6"><con:settings/><con:config service="https://images-api.nasa.gov" resourcePath="" methodName="captions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="captions" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/metadata/${Properties#nasa_id}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="1f4358fd-162a-4496-b248-dab27b288556" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="album" id="8569150e-b19b-43cb-b86e-7831bfa19fcf"><con:settings/><con:config service="https://images-api.nasa.gov" resourcePath="" methodName="album" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="album" id="41b0ac7d-7d8a-46e4-8f0b-52a8a066bfa0" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://images-api.nasa.gov/album/${Properties#album_name}</con:endpoint><con:request/><con:originalUri>https://images-api.nasa.gov/</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="2476d9b2-68f4-4e4a-8e6a-7b713cd60f46" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="photographs" id="fd0abb48-8d8d-40d5-bd68-b34c53039065"><con:settings/><con:config><script>import groovy.json.*

log.info ' search image: ' + testRunner.runTestStepByName('search image').status
//Check empty response
response = testRunner.testCase.testSteps['search image'].testRequest.response
if (response == null) {
	statusCode = 0
	log.info ' search image = Empty response!'	
} else {
	//Check status
	statusCode = testRunner.testCase.testSteps['search image'].testRequest.response.statusCode
	response = context.expand('${search image#Response}')	
	if (statusCode != 404 &amp;&amp; statusCode != 503) {
		items  = new JsonSlurper().parseText(context.expand('${search image#Response#$.collection.items[*]}' )).size()
		for (i = 0; i &lt; items; i++) {
			log.info ' photograph ' +  ( i + 1) + '  =  ' + context.expand( '${search image#Response#$.collection.items[' + i + '].links[0].href}}' )	
		}
	} else {
		log.info ' statusCode = ' + statusCode
	}			
}</script></con:config></con:testStep><con:testStep type="groovy" name="video files" id="b9b1a528-cc60-4edd-b8de-6ba980cb5579"><con:settings/><con:config><script><![CDATA[import groovy.json.*

log.info ' search video: ' + testRunner.runTestStepByName('search video').status
//Check empty response
response = testRunner.testCase.testSteps['search video'].testRequest.response
if (response == null) {
	statusCode = 0
	log.info ' search video = Empty response!'	
} else {
	//Check status
	statusCode = testRunner.testCase.testSteps['search video'].testRequest.response.statusCode
	response = context.expand('${search video#Response}')	
	if (statusCode != 404 && statusCode != 503) {
		items  = new JsonSlurper().parseText(context.expand('${search video#Response#$.collection.items[*]}' )).size()
		for (i = 0; i < items; i++) {
			nasa_id = context.expand( '${search video#Response#$.collection.items[' + i + '].data[0].nasa_id}' )
			testRunner.testCase.testSteps['Properties'].setPropertyValue('nasa_id', nasa_id)
			log.info ' nasa_id  ' +  ( i + 1) + ':  ' + nasa_id
			log.info ' ----------  '
			log.info ' asset: ' + testRunner.runTestStepByName('asset').status
			
			statusCode = testRunner.testCase.testSteps['asset'].testRequest.response.statusCode
			if (statusCode != 404 && statusCode != 503) {
				mp4 = new JsonSlurper().parseText(context.expand('${asset#Response#$.collection.items[*]}' )).findAll {
															it.href =~ '.mp4'}
				for (j = 0; j < mp4.size(); j++) {
					log.info ' video file  ' +  ( j + 1) + '  =  ' + mp4[j]
				}
				log.info ' ----------------------------------  '
			} else {
				log.info ' statusCode = ' + statusCode
			}		
		}
	} else {
		log.info ' statusCode = ' + statusCode
	}
}]]></script></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/></con:soapui-project>